/* Generated by LabelConnector plugin - remove this comment if you don't want the plugin to override your custom label style*/
/* 
alias_en="Break aligned"
alias_fr="Lignes brisées régulières"
*/

   
geomfromwkt( 
-- start 01 upper left quadrant - more vertical move 
  if(  
    "auxiliary_storage_labeling_positionx" < x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) and "auxiliary_storage_labeling_positiony" > y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) and  ( abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) < abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) ) ,         
    'LINESTRING('+ to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) +' '+ to_string(y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) + ' , ' 
    + to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) - abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) )) +' ' --middleX
    + to_string("auxiliary_storage_labeling_positiony") + ' ,'                                   --middleY
    + to_string("auxiliary_storage_labeling_positionx") + ' '
    + to_string("auxiliary_storage_labeling_positiony")+ ')' 
    
    ,  -- start 02 upper left quadrant - more horizontal move 
    
     if(  
        "auxiliary_storage_labeling_positionx" < x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) and "auxiliary_storage_labeling_positiony" > y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))    and  abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) >= abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) )  ,         
        'LINESTRING('+ to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) +' '+ to_string(y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) + ' , ' 
        + to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )))  +' '                                                                --middleX
        + to_string(y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) + abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) )) + ' ,' --middleY
        + to_string("auxiliary_storage_labeling_positionx") + ' '
        + to_string("auxiliary_storage_labeling_positiony")+ ')' 
        
        ,  
            -- start 03  lower left case 1 
            if(  
           "auxiliary_storage_labeling_positionx" < x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))   and "auxiliary_storage_labeling_positiony" <= y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))    and  abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) < abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) )  ,         
            'LINESTRING('+ to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) +' '+ to_string(y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) + ' , ' 
            + to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) - abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ))  +' '   --middleX
            + to_string( "auxiliary_storage_labeling_positiony") + ' ,'                                     --middleY
            + to_string("auxiliary_storage_labeling_positionx") + ' '
            + to_string("auxiliary_storage_labeling_positiony")+ ')' 
            , 
                 -- start 04  lower left case 2 
                if( "auxiliary_storage_labeling_positionx" < x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) and "auxiliary_storage_labeling_positiony" <= y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))    and  abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) >= abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) ,
                     'LINESTRING('+ to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) +' '+ to_string(y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) + ' , ' 
                    + to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )))  +' '                                                                --middleX
                    + to_string( y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) - abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) )) + ' ,'--middleY
                    + to_string("auxiliary_storage_labeling_positionx") + ' '
                    + to_string("auxiliary_storage_labeling_positiony")+ ')' 
                    ,
                    -- start 05  Upper right case 1
                    if( "auxiliary_storage_labeling_positionx" >= x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) and "auxiliary_storage_labeling_positiony" > y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))     and abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) >= abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) ,
                        'LINESTRING('+ to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) +' '+ to_string(y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) + ' , ' 
                        + to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )))  +' '                                                                --middleX
                        + to_string( "auxiliary_storage_labeling_positiony" - abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) )) + ' ,'--middleY
                        + to_string("auxiliary_storage_labeling_positionx") + ' '
                        + to_string("auxiliary_storage_labeling_positiony")+ ')' 
                        ,
                          -- start 06  Upper right case 2
                        if( "auxiliary_storage_labeling_positionx" >= x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))  and "auxiliary_storage_labeling_positiony" > y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))    and abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) < abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) ,
                            'LINESTRING('+ to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) +' '+ to_string(y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) + ' , ' 
                            + to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) + abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ))  +' ' --middleX
                            + to_string("auxiliary_storage_labeling_positiony") + ' ,'                                    --middleY
                            + to_string("auxiliary_storage_labeling_positionx") + ' '
                            + to_string("auxiliary_storage_labeling_positiony")+ ')' 
                            ,
                            -- start 07  Lower right case 1
                            if( "auxiliary_storage_labeling_positionx" >= x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) and "auxiliary_storage_labeling_positiony" <= y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))    and abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) >= abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) ,
                                'LINESTRING('+ to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) +' '+ to_string(y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) + ' , ' 
                                + to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )))  + ' '                                                               --middleX
                                + to_string(y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) - abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) )) + ' ,' --middleY
                                + to_string("auxiliary_storage_labeling_positionx") + ' '
                                + to_string("auxiliary_storage_labeling_positiony")+ ')' 
                                ,
                                -- start 08  Lower right case 2
                                if( "auxiliary_storage_labeling_positionx" >= x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) and "auxiliary_storage_labeling_positiony" <= y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))    and abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) < abs("auxiliary_storage_labeling_positionx" - x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) ,
                                    'LINESTRING('+ to_string(x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) +' '+ to_string(y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) ))) + ' , ' 
                                    + to_string( x(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) + abs("auxiliary_storage_labeling_positiony" - y(if( layer_property( @layer_name, 'geometry_type' ) = 'Line', closest_point( $geometry, make_point("auxiliary_storage_labeling_positionx"       , "auxiliary_storage_labeling_positiony") ), centroid($geometry) )) ) )  + ' ' --middleX
                                    + to_string("auxiliary_storage_labeling_positiony") + ' ,'                                       --middleY
                                    + to_string("auxiliary_storage_labeling_positionx") + ' '
                                    + to_string("auxiliary_storage_labeling_positiony")+ ')' 
                                    ,
                                    'ELSE'
                                
                                ) -- end 08
                            
                             ) -- end 07

                        ) -- end 06
                     
                    ) -- end 05

                ) -- end 04

            )  -- end 03

        ) -- end 02
    
    )  			
)

/* End of generated expression */
